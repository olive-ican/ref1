<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Current Promotions</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>

<div class="container mt-5">
    <div class="d-flex justify-content-between align-items-center mb-4 ">
        <h1>현재 진행 중인 프로모션</h1>
    </div>

    <table class="table table-striped mt-4">
        <thead>
        <tr>
            <th>상품 코드</th>
            <th>상품명</th>
            <th>프로모션 가격</th>
            <th>시작일</th>
            <th>종료일</th>
        </tr>
        </thead>
        <tbody>
        <!-- 데이터가 여기에 동적으로 추가됩니다. -->
        </tbody>
    </table>
</div>

<script>
    function fetchPromotions() {
        let url = '/api/v1/promotions';

        fetch(url)
            .then(response => response.json())
            .then(data => {
                const tbody = document.querySelector("table tbody");
                tbody.innerHTML = ''; // 기존 내용을 비웁니다.

                if (data.length === 0) {
                    tbody.innerHTML = '<tr><td colspan="5" class="text-center">조회된 프로모션이 없습니다.</td></tr>';
                    return;
                }

                data.forEach(promo => {
                    const row = `
                        <tr>
                            <td>${promo.prodCd}</td>
                            <td>${promo.prodNm}</td>
                            <td>${promo.promoPrice.toLocaleString()}원</td>
                            <td>${promo.startDt}</td>
                            <td>${promo.endDt}</td>
                        </tr>
                    `;
                    tbody.innerHTML += row;
                });
            })
            .catch(error => {
                console.error('Error fetching promotions:', error);
                const tbody = document.querySelector("table tbody");
                tbody.innerHTML = '<tr><td colspan="5" class="text-center">데이터를 불러오는 중 오류가 발생했습니다.</td></tr>';
            });
    }

    document.addEventListener("DOMContentLoaded", function() {
        fetchPromotions(); // 페이지 로드 시 프로모션 바로 불러오기
    });
</script>

</body>
</html>
